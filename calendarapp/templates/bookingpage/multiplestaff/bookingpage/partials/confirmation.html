{% load static %}
<div class="justify-content-between align-baseline pl-4 row mb-6">
    <div class="row align-middle">
        <div class="clickme hovermeclick" data-staff="{{ staff.id }}">
        <svg xlmns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
            <path fill="#181818" d="M12.859 1.49l-7.08 7.39-.097.112c-.232.303-.349.65-.349 1.008 0 .419.16.822.447 1.121l7.079 7.389.098.089c.452.342 1.04.295 1.408-.09l.085-.101.062-.1c.246-.437.186-.962-.147-1.309L7.66 10l6.706-6.999.085-.102c.316-.455.273-1.035-.085-1.409-.413-.431-1.093-.431-1.506 0z"></path>
        </svg>
        </div>
        <h4> Additional Info</h4>
    </div>
    <button class="text-muted btn btn-sm btn-link" data-toggle="modal" data-target="#notesModal">{% if company.shownotes %}Policy{% endif %}</button>
</div>
<ul class="progressbar text-left">
    <li class="completedprog" style="left: 0px;"></li>
    <li class="completedprog" style="left: 25%;"></li>
    <li class="completedprog" style="left: 50%;"></li>
    <li class="completedprog" style="left: 75%;"></li>
    <li style="left: 100%;"></li>
    <span style="width: 75%;"></span>
</ul>
<div class="status-info information">
    <h6>{{ service.name }}</h6>
    <p>with {% if staff.user %}{{ staff.user.first_name }}{% else %}{{ staff.first_name }}{% endif %}</p>
    {% if collectpayment %}
        <p><strong>Total Due Now:</strong> ${{ thepayment|floatformat:2 }}</p>
        <p><strong>Due at the time of appointment:</strong> ${{ paymentduelater|floatformat:2 }}</p>
        {% if staff.collectnrfpayment %}
            <p class="small"><strong class="text-muted">Non-refundable deposit:</strong> ${{ staff.nrfpayment }}</p>
        {% endif %}
    {% endif %}
</div>
<div class="text-block">
<form method="POST" id='fconfirmationform'>
    {% csrf_token %}
    <div class="row mb-3">
        <div class="col-5 ml-auto mr-1 d-flex align-items-center mb-3 mb-md-0 bg-light rounded text-white">
            <div class="date-tile mr-3">
                <div class="text-uppercase"> <span class="text-sm" id="sm-mon">{{ date|date:'M' }}</span><br><strong class="text-lg" id="numdate">{{ date|date:'j' }}</strong></div>
            </div>
            <p class="text-sm mb-0" id="serDate">{{ date|date:'l' }}<br> {{ time }} </p>
        </div>
        <div class="col-5 mr-auto ml-1 d-flex align-items-left mb-3 mb-md-0 bg-light rounded text-white">
            <p class="text-sm mb-0 text-left" id="serDate"> {% if service_duration_hour > 0 %}{{ service_duration_hour }} hour{% endif %} {% if service_duration_minute > 0 and service_duration_hour > 0 %}and{% endif %} {{ service_duration_minute}} minute service.</p>
        </div>
    </div>
{% if company.company_forms.all or company.category.name == 'Automotive Services' %}
    <h4>Fill out the following form</h4>
{% endif %}
{% if company.category.name == 'Automotive Services' %}
    <div class="col-12 text-left">
        <label for="">Vehicle Year:</label>
        <select name="car-years" id="car-years" class="vehyearselect m-1" data-size='6' data-live-search='true' data-live-search-placeholder='Vehicle Year' required></select>  
    </div>
    <div class="col-12 text-left">
        <label for="">Vehicle Make:</label>
        <select name="car-makes" id="car-makes" class="vehmakeselect m-1" data-size='6' data-live-search='true' data-live-search-placeholder='Vehicle Make' required></select> 
    </div>
    <div class="col-12 text-left">
        <label for="">Vehicle Model:</label>
        <select name="car-models" id="car-models" class="vehmodelselect m-1" data-size='6' data-live-search='true' data-live-search-placeholder='Vehicle Model' required></select>
    </div>
    <div class="col-12 text-left">
        <label for="">Vehicle Trim:</label>
        <select name="car-model-trims" id="car-model-trims" class="vehtrimselect m-1" data-size='6' data-live-search='true' data-live-search-placeholder='Vehicle Trim' required></select>
    </div>
{% endif %}

{% for formfield in service.service_forms.all %}
    <div class="col-12 text-left">
        <label for="">{{ formfield.label }}{% if formfield.is_required == 'y' %}*{% endif %}:</label>
        <input type="text" name="{{ formfield.id }}" class="form-control {{ formfield.id }}" {% if formfield.is_required == 'y' %}required{% endif %}>
    </div>
{% endfor %}

{% if collectpayment %}
    <div class="col-12 p-0 text-left">
        <div class="text-block my-2">
            <h4>Payment Method</h4>
        </div>
        <p class="text-muted small">All transactions are secure and encrypted. BookMe won't save your card.</p>
        <div class="py-3 pr-1 pl-0 rounded mt-2 bordpayment">
            <div class="d-flex align-items-center">
                {% comment %} <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 76c48.1 0 93.3 18.7 127.3 52.7S436 207.9 436 256s-18.7 93.3-52.7 127.3S304.1 436 256 436c-48.1 0-93.3-18.7-127.3-52.7S76 304.1 76 256s18.7-93.3 52.7-127.3S207.9 76 256 76m0-28C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"></path><path d="M363.5 148.5C334.8 119.8 296.6 104 256 104c-40.6 0-78.8 15.8-107.5 44.5C119.8 177.2 104 215.4 104 256s15.8 78.8 44.5 107.5C177.2 392.2 215.4 408 256 408c40.6 0 78.8-15.8 107.5-44.5C392.2 334.8 408 296.6 408 256s-15.8-78.8-44.5-107.5z"></path></svg> {% endcomment %}
                <div class="w-100 ml-3">
                    <div class="d-flex align-ittems-center justify-content-between">
                        <p style="font-weight:500">Credit Card</p>
                        <div class="d-flex align-items-center">
                            <img alt="visa" src="{% static 'css/svg-img/cards/visa.svg' %}" class="creditcard"></img:alt:src:class>
                            <img alt="mastercard" src="{% static 'css/svg-img/cards/mc_vrt_rev.svg' %}" class="creditcard"></img:alt:src:class>
                            <img alt="amex" src="{% static 'css/svg-img/cards/amex.svg' %}" class="creditcard"></img:alt:src:class>
                            <p class="text-muted small my-auto">&amp; more</p>
                        </div>
                    </div>
                    <div id="card-element" class="rounded mt-2 borderpayment" style="padding: 12px 8px;">
                    <!-- Elements will create input elements here -->
                    </div>
                    <!-- We'll put the error messages in this element -->
                    <div id="card-element-errors" role="alert"></div>
                    
                </div>
            </div>
            <button data-sitekey="6LeimeAZAAAAAE119rtvZivK4DW9csX6QhEo5Yla" data-callback='onSubmit' data-action='submit' class="btn btn-outline-primary px-3 my-3 mx-1" id="collectpayfirst" type="submit">
                <div class="spinner-border sr-only" id="spinner" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
                <span id="button-text">Pay and Secure Spot</span>
            </button>
        </div>
        
        
    </div>
        
{% else %}
    <div class="row form-block flex-column flex-sm-row my-4">
        <div class="col text-center"><button type='submit' data-sitekey="6LeimeAZAAAAAE119rtvZivK4DW9csX6QhEo5Yla" data-callback='onSubmit' data-action='submit' class="btn btn-outline-primary px-3 confbtn"> {% if request.user.is_authenticated %}Confirm and Secure Spot{% else %}Proceed to Final Step{% endif %}<i class="fa-chevron-right fa ml-2"></i></button></div>
    </div>
{% endif %}
</form>
</div>

{% comment %} {% if company.notes %}
    <div class="text-block">
        <h5 class="mb-4">Things to keep in mind</h5>
        <ul class="list-unstyled">
            <li class="mb-2"> 
                <div class="media align-items-center mb-3">
                    <div class="icon-rounded icon-rounded-sm bg-secondary-light mr-4"><i class="fa fas fa-info text-secondary fa-fw text-center"></i></div>
                    <div class="media-body"><span class="text-sm">{{ company.notes }}</span></div>
                </div>
            </li>
        </ul>
    </div>
{% endif %} {% endcomment %}