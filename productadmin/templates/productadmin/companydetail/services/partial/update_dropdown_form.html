{% load hosts %}
{% load crispy_forms_tags %}
{% block linkscript %}{{ product_form.media }}{% endblock linkscript %}
    <form method="POST" action="{% host_url 'updatedropdownprod' product.id host 'prodadmin' %}" id="form-containers" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" name="form-TOTAL_FORMS" value="{{ total_form_count }}" id="id_form-TOTAL_FORMSS">
        <input type="hidden" name="form-INITIAL_FORMS" value="0" id="id_form-INITIAL_FORMS">
        <input type="hidden" name="form-MIN_NUM_FORMS" value="0" id="id_form-MIN_NUM_FORMS">
        <input type="hidden" name="form-MAX_NUM_FORMS" value="1000" id="id_form-MAX_NUM_FORMS">
        <div class="row align-items-center">
            <div class="col-8">
                {{ placeholder_form.placeholder|as_crispy_field }}
            </div>
            <div class="col-4">
                <div class="form-check">
                    <label class="form-check-label">
                        <input class="form-check-input" {% if product.is_required %}checked{% endif %} name="requiredinput" type="checkbox">
                        <span class="form-check-sign"></span>
                        Required
                    </label>
                </div>
            </div>
        </div>
        
        <br>
        <div class="">
            <div class="row align-items-center">
                <div class="col-8">
                    <h5 class="modal-title {% if company.darkmode %}text-white{% endif %}" id="exampleModalLabel">Choices</h5>
                </div>
                <div class="col-4">
                    <div class="form-check">
                        <label class="form-check-label">
                            <input class="form-check-input" {% if product.is_multiple %}checked{% endif %} name="multiplechoices" type="checkbox">
                            <span class="form-check-sign"></span>
                            Choose multiple options
                        </label>
                    </div>
                </div>
                <div class="col-6"><label for="">Option<span class="asteriskField">*</span></label></div>
                <div class="col-6"><label for="">Additional Price<span class="asteriskField">*</span></label></div>
            </div>
            {% for option in option_form %}
            <div class="dropdownforms row">
                <div class="col-6">
                    {{ option.option|as_crispy_field }}
                </div>
                <div class="col-6">
                    <div class="input-group">
                        <div class="input-group-prepend">
                        <div class="input-group-text">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        </div>
                        <input type="number" name="{{ option.price.html_name }}" step="0.01" placeholder="Additional price of the option. (Enter zero if there is no additional cost)" class="numberinput form-control" id="{{option.price.auto_id}}" value='{{ option.price.value|default_if_none:"0.00" }}'>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <button class="btns btn-outline-info" type="button" id="add_mores">+ Add New Option</button>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-info">Update</button>
        </div>
    </form>
<script>
    var birdFormd = document.querySelectorAll(".dropdownforms")
    var containerd = document.querySelector("#form-containers")
    var addButtond = document.querySelector("#add_mores")
    var totalForms = document.querySelector("#id_form-TOTAL_FORMSS")
    console.log(birdFormd.length)

    var formNumd = birdFormd.length-1
    addButtond.addEventListener('click', addForms)

    function addForms(e){
        e.preventDefault()
        var newFormd = birdFormd[0].cloneNode(true)
        var formRegexd = RegExp(`form-(\\d){1}-`,'g')
        formNumd++
        newFormd.innerHTML = newFormd.innerHTML.replace(formRegexd, `form-${formNumd}-`)
        containerd.insertBefore(newFormd, addButtond)
        totalForms.setAttribute('value', `${formNumd+1}`)
    }
</script>